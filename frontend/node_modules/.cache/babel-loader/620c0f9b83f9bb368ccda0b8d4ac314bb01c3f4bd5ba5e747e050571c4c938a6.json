{"ast":null,"code":"// frontend/src/components/Chat.js\nimport React,{useState,useEffect,useRef}from'react';// Убираем chatEndRef из пропсов, компонент теперь сам управляет прокруткой\nimport{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function Chat(_ref){let{messages,onSendMessage}=_ref;const[messageInput,setMessageInput]=useState('');// Создаем ref прямо здесь\nconst messagesEndRef=useRef(null);// Функция для плавной прокрутки вниз\nconst scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});};// Вызываем прокрутку каждый раз, когда обновляется массив сообщений\nuseEffect(()=>{scrollToBottom();},[messages]);const handleSend=()=>{if(messageInput.trim()){onSendMessage(messageInput.trim());setMessageInput('');}};const handleKeyPress=e=>{if(e.key==='Enter'){handleSend();}};return(/*#__PURE__*/// Этот div теперь является основным flex-контейнером для чата\n_jsxs(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-messages\",children:[messages.map(msg=>/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message \".concat(msg.sender==='system'?'system-message':''),children:[/*#__PURE__*/_jsxs(\"span\",{className:\"message-sender\",children:[msg.sender,\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"message-text\",children:msg.message})]},msg.id)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:messageInput,onChange:e=>setMessageInput(e.target.value),onKeyPress:handleKeyPress,placeholder:\"\\u041D\\u0430\\u043F\\u0438\\u0448\\u0438\\u0442\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435...\",maxLength:\"150\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSend,className:\"btn primary\",children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]}));}export default Chat;","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxs","_jsxs","jsx","_jsx","Chat","_ref","messages","onSendMessage","messageInput","setMessageInput","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSend","trim","handleKeyPress","e","key","className","children","map","msg","concat","sender","message","id","ref","type","value","onChange","target","onKeyPress","placeholder","maxLength","onClick"],"sources":["C:/Users/stanislav/Desktop/who-am-i-game/frontend/src/components/Chat.js"],"sourcesContent":["// frontend/src/components/Chat.js\r\nimport React, { useState, useEffect, useRef } from 'react';\r\n\r\n// Убираем chatEndRef из пропсов, компонент теперь сам управляет прокруткой\r\nfunction Chat({ messages, onSendMessage }) {\r\n  const [messageInput, setMessageInput] = useState('');\r\n  // Создаем ref прямо здесь\r\n  const messagesEndRef = useRef(null);\r\n\r\n  // Функция для плавной прокрутки вниз\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n\r\n  // Вызываем прокрутку каждый раз, когда обновляется массив сообщений\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n\r\n  const handleSend = () => {\r\n    if (messageInput.trim()) {\r\n      onSendMessage(messageInput.trim());\r\n      setMessageInput('');\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter') {\r\n      handleSend();\r\n    }\r\n  };\r\n\r\n  return (\r\n    // Этот div теперь является основным flex-контейнером для чата\r\n    <div className=\"chat-container\">\r\n      <div className=\"chat-messages\">\r\n        {messages.map((msg) => (\r\n          <div key={msg.id} className={`chat-message ${msg.sender === 'system' ? 'system-message' : ''}`}>\r\n            <span className=\"message-sender\">{msg.sender}:</span>\r\n            <span className=\"message-text\">{msg.message}</span>\r\n          </div>\r\n        ))}\r\n        {/* Пустой div в конце, к которому мы будем прокручивать */}\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n      <div className=\"chat-input-group\">\r\n        <input\r\n          type=\"text\"\r\n          value={messageInput}\r\n          onChange={(e) => setMessageInput(e.target.value)}\r\n          onKeyPress={handleKeyPress}\r\n          placeholder=\"Напишите сообщение...\"\r\n          maxLength=\"150\"\r\n        />\r\n        <button onClick={handleSend} className=\"btn primary\">\r\n          Отправить\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAE1D;AAAA,OAAAC,IAAA,IAAAC,KAAA,CAAAC,GAAA,IAAAC,IAAA,yBACA,QAAS,CAAAC,IAAIA,CAAAC,IAAA,CAA8B,IAA7B,CAAEC,QAAQ,CAAEC,aAAc,CAAC,CAAAF,IAAA,CACvC,KAAM,CAACG,YAAY,CAAEC,eAAe,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACpD;AACA,KAAM,CAAAa,cAAc,CAAGX,MAAM,CAAC,IAAI,CAAC,CAEnC;AACA,KAAM,CAAAY,cAAc,CAAGA,CAAA,GAAM,KAAAC,qBAAA,CAC3B,CAAAA,qBAAA,CAAAF,cAAc,CAACG,OAAO,UAAAD,qBAAA,iBAAtBA,qBAAA,CAAwBE,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CAChE,CAAC,CAED;AACAjB,SAAS,CAAC,IAAM,CACda,cAAc,CAAC,CAAC,CAClB,CAAC,CAAE,CAACL,QAAQ,CAAC,CAAC,CAGd,KAAM,CAAAU,UAAU,CAAGA,CAAA,GAAM,CACvB,GAAIR,YAAY,CAACS,IAAI,CAAC,CAAC,CAAE,CACvBV,aAAa,CAACC,YAAY,CAACS,IAAI,CAAC,CAAC,CAAC,CAClCR,eAAe,CAAC,EAAE,CAAC,CACrB,CACF,CAAC,CAED,KAAM,CAAAS,cAAc,CAAIC,CAAC,EAAK,CAC5B,GAAIA,CAAC,CAACC,GAAG,GAAK,OAAO,CAAE,CACrBJ,UAAU,CAAC,CAAC,CACd,CACF,CAAC,CAED,oBACE;AACAf,KAAA,QAAKoB,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BrB,KAAA,QAAKoB,SAAS,CAAC,eAAe,CAAAC,QAAA,EAC3BhB,QAAQ,CAACiB,GAAG,CAAEC,GAAG,eAChBvB,KAAA,QAAkBoB,SAAS,iBAAAI,MAAA,CAAkBD,GAAG,CAACE,MAAM,GAAK,QAAQ,CAAG,gBAAgB,CAAG,EAAE,CAAG,CAAAJ,QAAA,eAC7FrB,KAAA,SAAMoB,SAAS,CAAC,gBAAgB,CAAAC,QAAA,EAAEE,GAAG,CAACE,MAAM,CAAC,GAAC,EAAM,CAAC,cACrDvB,IAAA,SAAMkB,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAEE,GAAG,CAACG,OAAO,CAAO,CAAC,GAF3CH,GAAG,CAACI,EAGT,CACN,CAAC,cAEFzB,IAAA,QAAK0B,GAAG,CAAEnB,cAAe,CAAE,CAAC,EACzB,CAAC,cACNT,KAAA,QAAKoB,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BnB,IAAA,UACE2B,IAAI,CAAC,MAAM,CACXC,KAAK,CAAEvB,YAAa,CACpBwB,QAAQ,CAAGb,CAAC,EAAKV,eAAe,CAACU,CAAC,CAACc,MAAM,CAACF,KAAK,CAAE,CACjDG,UAAU,CAAEhB,cAAe,CAC3BiB,WAAW,CAAC,4GAAuB,CACnCC,SAAS,CAAC,KAAK,CAChB,CAAC,cACFjC,IAAA,WAAQkC,OAAO,CAAErB,UAAW,CAACK,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,wDAErD,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,EAEV,CAEA,cAAe,CAAAlB,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}